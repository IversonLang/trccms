#generated by `lor framework`
    
# user www www;
pid tmp/dev-nginx.pid;

# This number should be at maxium the number of CPU on the server
worker_processes 4;

events {
    # Number of connections per worker
    worker_connections 4096;
}

http {
    # use sendfile
    include ./mime.types;

    sendfile on;
    
    # include #NGX_PATH/conf/mime.types;

    # lor initialization
    lua_package_path "./app/?.lua;./?.lua;/opt/lor/?.lua;/opt/lor/?/init.lua;;";
    lua_package_cpath "./app/library/?.so;/opt/lor/?.so;;";
    lua_code_cache on;
    #LUA_SHARED_DICT

    # lua_package_path "./app/?.lua;./?.lua;/opt/lor/?.lua;/opt/lor/?/init.lua;;";
    # lua_package_cpath "./app/library/?.so;/opt/lor/?.so;;";
    # lua_code_cache on;



    
    
    
    

    server {
        # List port

        listen 8888;
        
        server_name localhost;

        set $template_root '';
        client_max_body_size  10m;
        client_body_buffer_size  1024k;
        # 用户上传的静态文件目录
        # set $static_files_path "/data/openresty-china/static";
        set $static_files_path "/opt/trccms/data/static";
        # 头像和文章、评论图片
        location /static/avatar {
            alias $static_files_path;
        }
        location /static/files {
            alias $static_files_path/web;
        }

        location /static/images {
            alias $static_files_path/ImgSource;
        }

        location /static/uploader {
            alias $static_files_path/uploader;
        }

        # 项目本身的静态文件
        location /static/css {
            alias ./app/static/css;
        }
        location /static/community {
            alias ./app/static/community;
        }
        location /static/fonts {
            alias ./app/static/fonts;
        }
        location /static/js {
            alias ./app/static/js;
        }
        location /static/libs {
            alias ./app/static/libs;
        }

        # Access log with buffer, or disable it completetely if unneeded
        access_log logs/dev-access.log combined buffer=16k;
        # access_log off;

        # Error log
        error_log logs/dev-error.log;

        # lor runtime
        location / {
            content_by_lua_file ./app/main.lua;
        }

        location /trc/images/ {
            alias /home/trc/upload/images/;
            expires 24h;
        }
        
        location /trc/temp/ {
            alias /home/trc/upload/temp/;
            expires 24h;
        }
        location /trc {
            proxy_pass http://127.0.0.1:8080/trc;
        }   
    }
}

    